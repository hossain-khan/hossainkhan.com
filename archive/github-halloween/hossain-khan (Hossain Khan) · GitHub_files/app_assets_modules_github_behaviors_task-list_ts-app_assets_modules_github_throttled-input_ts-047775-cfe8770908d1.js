"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([["app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_throttled-input_ts-047775"],{18651:(e,t,n)=>{n.d(t,{Fr:()=>l,R0:()=>r,U0:()=>a,xl:()=>o});var i=n(71315);let s={Android:"Android",iOS:"iOS",macOS:"macOS",Windows:"Windows",Linux:"Linux",Unknown:"Unknown"};function r(){let e=s.Unknown,t=!1;if(i.cg){let n=i.cg.navigator,r="";try{r=n.userAgent}catch{}let l="";try{l=n?.userAgentData?.platform||n.platform}catch{}-1!==["Macintosh","MacIntel","MacPPC","Mac68K","macOS"].indexOf(l)?e=s.macOS:-1!==["iPhone","iPad","iPod"].indexOf(l)?e=s.iOS:-1!==["Win32","Win64","Windows","WinCE"].indexOf(l)?e=s.Windows:/Android/.test(r)?e=s.Android:/Linux/.test(l)&&(e=s.Linux),t=n?.userAgentData?.mobile??(e===s.Android||e===s.iOS)}return{os:e,isAndroid:e===s.Android,isIOS:e===s.iOS,isMacOS:e===s.macOS,isWindows:e===s.Windows,isLinux:e===s.Linux,isDesktop:e===s.macOS||e===s.Windows||e===s.Linux,isMobile:t}}function l(){return r().isMobile}function o(){return r().isDesktop}function a(){return r().isMacOS}},19117:(e,t,n)=>{n.d(t,{NB:()=>c,Up:()=>a,pk:()=>u});let i=new WeakMap;function s(e){let t=i.get(e);t&&(null!=t.timer&&clearTimeout(t.timer),t.timer=window.setTimeout(()=>{null!=t.timer&&(t.timer=null),t.inputed=!1,t.listener.call(null,e)},t.wait))}function r(e){let t=e.currentTarget,n=i.get(t);n&&(n.keypressed=!0,null!=n.timer&&clearTimeout(n.timer))}function l(e){let t=e.currentTarget,n=i.get(t);n&&(n.keypressed=!1,n.inputed&&s(t))}function o(e){let t=e.currentTarget,n=i.get(t);n&&(n.inputed=!0,n.keypressed||s(t))}function a(e,t,n={wait:null}){i.set(e,{keypressed:!1,inputed:!1,timer:void 0,listener:t,wait:null!=n.wait?n.wait:100}),e.addEventListener("keydown",r),e.addEventListener("keyup",l),e.addEventListener("input",o)}function c(e,t){e.removeEventListener("keydown",r),e.removeEventListener("keyup",l),e.removeEventListener("input",o);let n=i.get(e);n&&(null!=n.timer&&n.listener===t&&clearTimeout(n.timer),i.delete(e))}function u(e){let t=i.get(e);t&&t.listener.call(null,e)}},33303:(e,t,n)=>{function i(){return Promise.resolve()}function s(){return new Promise(window.requestAnimationFrame)}async function r(e,t){let n,i=new Promise(t=>{n=self.setTimeout(t,e)});if(!t)return i;try{var s;await Promise.race([i,(s=t,new Promise((e,t)=>{let n=Error("aborted");n.name="AbortError",s.aborted?t(n):s.addEventListener("abort",()=>t(n))}))])}catch(e){throw self.clearTimeout(n),e}}function l(e){let t=[];return function(n){t.push(n),1===t.length&&queueMicrotask(()=>{let n=t.slice(0);t.length=0,e(n)})}}n.d(t,{G$:()=>s,k2:()=>i,rK:()=>l,uk:()=>r})},44569:(e,t,n)=>{n.d(t,{$$:()=>c,GI:()=>l,fg:()=>a,zw:()=>r});var i=n(18651),s=n(87465);let r=()=>{if("undefined"==typeof document)return!1;let e=document.querySelector("meta[name=keyboard-shortcuts-preference]");return!e||"all"===e.content},l=e=>/Enter|Arrow|Escape|Meta|Control|Mod|Esc|Tab/.test(e)||!(0,i.U0)()&&e.includes("Alt")&&e.includes("Shift"),o=new Set(["button","checkbox","color","file","hidden","image","radio","range","reset","submit"]);function a(e){if(!(e instanceof HTMLElement))return!1;let t=e.nodeName.toLowerCase(),n=e.getAttribute("type")?.toLowerCase()??"text",i="true"===e.ariaReadOnly||"true"===e.getAttribute("aria-readonly")||null!==e.getAttribute("readonly");return("select"===t||"textarea"===t||"input"===t&&!o.has(n)||e.isContentEditable)&&!i}let c=e=>{let t=(0,s.Vy)(e),n=r()&&!a(e.target);return l(t)||n}},74868:(e,t,n)=>{n.d(t,{df:()=>c});var i=n(96123),s=n(97797),r=n(72705),l=n(21403),o=n(58371),a=n(46865);function c(e){if(e.querySelector(".js-task-list-field")){for(let t of e.querySelectorAll("task-lists"))if(t instanceof r.A)for(let e of(t.disabled=!1,t.querySelectorAll("button")))e.disabled=!1}}function u(e,t,n){let i=e.querySelector(".js-comment-update");for(let t of e.querySelectorAll("task-lists"))if(t instanceof r.A)for(let e of(t.disabled=!0,t.querySelectorAll("button")))e.disabled=!0;x(e);let s=i.elements.namedItem("task_list_track");s instanceof Element&&s.remove();let l=i.elements.namedItem("task_list_operation");l instanceof Element&&l.remove();let o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name","task_list_track"),o.setAttribute("value",t),i.appendChild(o);let c=document.createElement("input");if(c.setAttribute("type","hidden"),c.setAttribute("name","task_list_operation"),c.setAttribute("value",JSON.stringify(n)),i.appendChild(c),!i.elements.namedItem("task_list_key")){let e=i.querySelector(".js-task-list-field").getAttribute("name").split("[")[0],t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","task_list_key"),t.setAttribute("value",e),i.appendChild(t)}e.classList.remove("is-comment-stale"),(0,a.k_)(i)}(0,l.lB)(".js-task-list-container .js-task-list-field",function(e){let t=e.closest(".js-task-list-container");c(t),x(t)}),(0,l.lB)(".js-convert-tasklist-to-block-enabled .contains-task-list",function(e){let t=E(e);if(!t||Array.from(t.children).some(e=>e.classList.contains("task-list-item-convert-container")))return;let n=e.ownerDocument.querySelector(".js-convert-to-block-template"),i=n?.content.cloneNode(!0);i&&t.appendChild(i)}),(0,s.on)("task-lists-move","task-lists",function(e){let{src:t,dst:n}=e.detail;u(e.currentTarget.closest(".js-task-list-container"),"reordered",{operation:"move",src:t,dst:n})}),(0,s.on)("task-lists-check","task-lists",function(e){let{position:t,checked:n}=e.detail;u(e.currentTarget.closest(".js-task-list-container"),`checked:${+!!n}`,{operation:"check",position:t,checked:n})}),(0,s.on)("click",".js-convert-to-block-button",function(e){let t=E(e.target);if(!t)return;if(!t.closest("task-lists"))throw Error("parent not found");let n=function(e){let t=e.closest("task-lists");if(!t)throw Error("parent not found");return Array.from(t.querySelectorAll("ol, ul")).filter(e=>!e.closest("tracking-block")).indexOf(e)}(t);u(e.currentTarget.closest(".js-task-list-container"),"converted",{operation:"convert_to_block",position:n})}),(0,o.JW)(".js-task-list-container .js-comment-update",async function(e,t){let n,i=e.closest(".js-task-list-container"),s=e.elements.namedItem("task_list_track");s instanceof Element&&s.remove();let r=e.elements.namedItem("task_list_operation");r instanceof Element&&r.remove();try{n=await t.json()}catch(t){let e;try{e=JSON.parse(t.response.text)}catch{}if(e&&e.stale){let e=i.querySelector(".js-task-list-field");e.classList.add("session-resumable-canceled"),e.classList.remove("js-session-resumable")}else 422===t.response.status||window.location.reload()}n&&(r&&n.json.source&&(i.querySelector(".js-task-list-field").value=n.json.source),c(i),requestAnimationFrame(()=>x(i)))});let d=!1,m=!1,f=null;function p(e){d="insertLineBreak"===e.inputType}function k(e){(d||"insertLineBreak"===e.inputType)&&(function(e){let t=function(e,t){let n=t[0];if(!n||!e)return;let i=e.substring(0,n).split(`
`),s=i[i.length-2],r=s?.match(A);if(!r)return;let l=r[0],o=r[1],a=r[2],c=parseInt(r[3],10),u=!!r[4],d=!isNaN(c),m=d?`${c+1}.`:a,f=`${m} ${u?"[ ] ":""}`,p=e.indexOf(`
`,n);p<0&&(p=e.length);let k=e.substring(n,p);if(k.startsWith(f)&&(f=""),s.replace(l,"").trim().length>0||k.trim().length>0){let t=`${o}${f}`,i=e.substring(n),s=t.length,r=[null,null],l=e.substring(0,n)+t+i;if(d&&!e.substring(n).match(/^\s*$/g)){var b,g;b=e.substring(n),g=c+1,t+=i=b.split(`
`).map(e=>{if(e.replace(/^\s+/,"").startsWith(`${g}.`)){let t=e.replace(`${g}`,`${g+1}`);return g+=1,t}return e}).join(`
`),r=[n,n+t.length],l=e.substring(0,n)+t}return{text:l,autocompletePrefix:t,selection:[n+s,n+s],commandId:S.insertText,writeSelection:r}}{let t=n-`
${l}`.length;return{autocompletePrefix:"",text:e.substring(0,t)+e.substring(n),selection:[t,t],commandId:S.delete,writeSelection:[null,null]}}}(e.value,[e.selectionStart,e.selectionEnd]);void 0!==t&&b(e,t)}(e.target),d=!1)}function b(e,t){if(null===f||!0===f){e.contentEditable="true";try{let n;d=!1,t.commandId===S.insertText?(n=t.autocompletePrefix,null!==t.writeSelection[0]&&null!==t.writeSelection[1]&&(e.selectionStart=t.writeSelection[0],e.selectionEnd=t.writeSelection[1])):e.selectionStart=t.selection[0],f=document.execCommand(t.commandId,!1,n)}catch{f=!1}e.contentEditable="false"}if(!f){try{document.execCommand("ms-beginUndoUnit")}catch{}e.value=t.text;try{document.execCommand("ms-endUndoUnit")}catch{}e.dispatchEvent(new CustomEvent("input",{bubbles:!0,cancelable:!0}))}null!=t.selection[0]&&null!=t.selection[1]&&(e.selectionStart=t.selection[0],e.selectionEnd=t.selection[1])}function g(e){if(!m&&"Enter"===e.key&&e.shiftKey&&!e.metaKey){let t=e.target,n=function(e,t){let n=t[0];if(!n||!e)return;let i=e.substring(0,n).split(`
`),s=i[i.length-1],r=s?.match(v);if(!r)return;let l=r[1]||"",o=`
${l}`;return{text:e.substring(0,n)+o+e.substring(n),autocompletePrefix:o,selection:[n+o.length,n+o.length],commandId:S.insertText,writeSelection:[null,null]}}(t.value,[t.selectionStart,t.selectionEnd]);if(void 0!==n)b(t,n),e.preventDefault(),(0,s.h)(t,"change")}}function h(){m=!0}function y(){m=!1}function w(e){if(m)return;if("Escape"===e.key)return void function(e){let t=e.target;"backward"===t.selectionDirection?t.selectionEnd=t.selectionStart:t.selectionStart=t.selectionEnd}(e);if("Tab"!==e.key)return;let t=e.target,n=function(e,t,n){let i=t[0]||0,s=t[1]||i;if(null===t[0]||i===s)return;let r=e.substring(0,i).lastIndexOf(`
`)+1,l=e.indexOf(`
`,s-1),o=l>0?l:e.length-1,a=e.substring(r,o).split(`
`),c=!1,u=0,d=0,m=[];for(let e of a){let t=e.match(/^\s*/);if(t){let i=t[0],s=e.substring(i.length);if(n){let e=i.length;i=i.slice(0,-2),u=c?u:i.length-e,c=!0,d+=i.length-e}else i+="  ",u=2,d+=2;m.push(i+s)}}let f=m.join(`
`);return{text:e.substring(0,r)+f+e.substring(o),selection:[Math.max(r,i+u),s+d],autocompletePrefix:f,commandId:S.insertText,writeSelection:[r,o]}}(t.value,[t.selectionStart,t.selectionEnd],e.shiftKey);void 0!==n&&(e.preventDefault(),b(t,n))}(0,l.lB)(".js-task-list-field",{subscribe:e=>(0,i.Zz)((0,i.Rt)(e,"keydown",w),(0,i.Rt)(e,"keydown",g),(0,i.Rt)(e,"beforeinput",p),(0,i.Rt)(e,"input",k),(0,i.Rt)(e,"compositionstart",h),(0,i.Rt)(e,"compositionend",y))});let S={insertText:"insertText",delete:"delete"},v=/^(\s*)?/,A=/^(\s*)([*-]|(\d+)\.)\s(\[[\sx]\]\s)?/;function x(e){if(0===document.querySelectorAll("tracked-issues-progress").length||e.closest(".js-timeline-item"))return;let t=e.querySelectorAll(".js-comment-body [type=checkbox]"),n=t.length,i=Array.from(t).filter(e=>e.checked).length;for(let e of document.querySelectorAll("tracked-issues-progress[data-type=checklist]"))e.setAttribute("data-completed",String(i)),e.setAttribute("data-total",String(n))}function E(e){let t=e.closest(".contains-task-list"),n=t;for(;(n=n.parentElement.closest(".contains-task-list"))!==t&&null!==n;)t=n;return t}}}]);
//# sourceMappingURL=app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_throttled-input_ts-047775-9bc0d6604fe7.js.map